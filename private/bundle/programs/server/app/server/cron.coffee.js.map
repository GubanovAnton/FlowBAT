{"version":3,"sources":["cron.coffee"],"names":[],"mappings":";AAAA;;AAAA,KAAK,CAAC,UAAN,GAAmB;AACjB,MAAG,KAAK,CAAC,iBAAT;AACE,UAAM,CAAC,MAAP,CAAc,sCAAd;AACA,WAFF;GAAA;AAAA,EAGA,KAAK,CAAC,iBAAN,GAA0B,IAH1B;AAIA;WACE,KAAK,CAAC,MAAM,CAAC,IAAb,EAAmB,CAAC,OAApB,CAA4B,SAAC,KAAD;AAC1B,UAAG,MAAM,CAAC,EAAE,CAAC,KAAT,CAAe,eAAf,CAAJ;AAEE,aAAK,CAAC,aAAN,CAAoB,KAApB,EAFF;OAAA;aAGA,KAAK,CAAC,MAAM,CAAC,MAAb,CAAoB,KAAK,CAAC,GAA1B,EAJ0B;IAAA,CAA5B,EADF;GAAA;AAOE,SAAK,CAAC,iBAAN,GAA0B,KAA1B,CAPF;GALiB;AAAA,CAAnB;;AAAA,eAcA,GAAkB,IAdlB;;AAAA,YAeA,GAAe;AACb;AAAA,YAAa,MAAM,CAAC,QAAQ,CAAC,QAAD,CAAO,CAAC,OAA1B,GAAuC,CAAvC,GAA8C,EAAxD;SACA,kBAAkB,MAAM,CAAC,WAAP,CAAmB,KAAK,CAAC,UAAzB,EAAqC,UAAU,IAA/C,EAFL;AAAA,CAff;;AAAA,MAmBM,CAAC,OAAP,CAAe;AACb,MAAG,MAAM,CAAC,QAAQ,CAAC,QAAD,CAAO,CAAC,OAA1B;AAAA;GAAA;WAGE,eAHF;GADa;AAAA,CAAf,CAnBA","file":"/server/cron.coffee.js","sourcesContent":["share.sendEmails = ->\n  if share.sendEmailsRunning\n    Meteor._debug(\"Send email already running; skipping\")\n    return\n  share.sendEmailsRunning = true\n  try\n    share.Emails.find().forEach (email) ->\n      if !email.to.match(/@flowbat.com$/)\n#        if Meteor.settings.public.isDebug then Meteor._debug('Sending \"'+email.subject+'\" to \"'+email.to+'\"')\n        Email.sendImmediate(email)\n      share.Emails.remove(email._id)\n  finally\n    share.sendEmailsRunning = false\n\nemailIntervalId = null\nsetIntervals = ->\n  seconds = if Meteor.settings.public.isDebug then 5 else 60\n  emailIntervalId = Meteor.setInterval(share.sendEmails, seconds * 1000)\n\nMeteor.startup ->\n  if Meteor.settings.public.isDebug\n#    setIntervals()\n  else\n    setIntervals()\n\n"]}