{"version":3,"sources":["routing.coffee"],"names":[],"mappings":";AAAA;;AAAA,KAAK,GAAG,CAAC,OAAJ,CAAY,IAAZ,CAAL;;AAAA,MAEM,CAAC,GAAP,CAAW;SACT,IAAC,MAAD,CAAO,MAAP,EAAe;AAAA,IACb,MAAM,cADO;AAAA,IAEb,OAAO,QAFM;AAAA,IAGb,QAAQ;AACN;AAAA,iBAAW,IAAC,OAAM,CAAC,KAAR,GAAgB,MAA3B;AAAA,MACA,WAAW,SAAS,GAAT,GAAe,QAD1B;AAEA;AACE,gBAAQ,EAAE,CAAC,QAAH,CAAY,QAAZ,CAAR;AACA,YAAG,KAAK,CAAC,MAAN,EAAH;AACE,cAAC,SAAQ,CAAC,SAAV,CAAoB,GAApB,EACE;AAAA,4BAAgB,0BAAhB;AAAA,YACA,kBAAkB,KAAK,CAAC,IADxB;AAAA,YAEA,UAAU,QAFV;AAAA,YAGA,WAAW,GAHX;AAAA,YAIA,iBAAiB,4CAJjB;AAAA,YAKA,uBAAuB,4BAA4B,QAA5B,GAAuC,IAL9D;AAAA,YAMA,6BAA6B,QAN7B;WADF;AAAA,UAQA,UAAU,EAAE,CAAC,YAAH,CAAgB,QAAhB,CARV;AAAA,UASA,IAAC,SAAQ,CAAC,KAAV,CAAgB,OAAhB,CATA;AAAA,UAUA,IAAC,SAAQ,CAAC,GAAV,EAVA;AAWA,iBAZF;SAFF;OAAA;AAeM,mBAfN;OAFA;AAAA,MAkBA,IAAC,SAAQ,CAAC,SAAV,CAAoB,GAApB,CAlBA;aAmBA,IAAC,SAAQ,CAAC,GAAV,GApBM;IAAA,CAHK;GAAf,EADS;AAAA,CAAX,CAFA","file":"/server/routing.coffee.js","sourcesContent":["fs = Npm.require('fs')\n\nRouter.map ->\n  @route('dump', {\n    path: '/dump/:token',\n    where: 'server',\n    action: ->\n      basename = @params.token + \".rwf\"\n      filename = \"/tmp\" + \"/\" + basename\n      try\n        stats = fs.statSync(filename)\n        if stats.isFile()\n          @response.writeHead 200,\n            \"Content-Type\": \"application/octet-stream\"\n            \"Content-Length\": stats.size\n            \"Pragma\": \"public\"\n            \"Expires\": \"0\"\n            \"Cache-Control\": \"must-revalidate, post-check=0, pre-check=0\"\n            \"Content-Disposition\": \"attachment; filename=\\\"\" + basename + \"\\\"\"\n            \"Content-Transfer-Encoding\": \"binary\"\n          content = fs.readFileSync(filename)\n          @response.write(content)\n          @response.end()\n          return\n      catch e\n      @response.writeHead(404)\n      @response.end()\n  })\n"]}