{"version":3,"sources":["queries.hooks.coffee"],"names":[],"mappings":";AAAA;;AAAA,KAAK,CAAC,OAAO,CAAC,MAAM,CAAC,MAArB,CAA4B,SAAC,MAAD,EAAS,KAAT,EAAgB,UAAhB,EAA4B,QAA5B,EAAsC,OAAtC;AAC1B,MAAG,CAAC,CAAC,YAAF,CAAe,UAAf,EAA2B,CAAC,QAAD,EAAW,cAAX,EAA2B,aAA3B,EAA0C,WAA1C,EAAuD,aAAvD,EAAsE,QAAtE,EAAgF,aAAhF,CAA3B,CAA0H,CAAC,MAA9H;AACE,YAAQ,CAAC,IAAT,GAAgB,QAAQ,CAAC,IAAT,IAAiB,EAAjC;AAAA,IACA,QAAQ,CAAC,IAAI,CAAC,aAAd,GAA8B,IAD9B,CADF;GAAA;AAGA,MAAG,CAAC,CAAC,YAAF,CAAe,UAAf,EAA2B,CAAC,WAAD,EAAc,QAAd,EAAwB,cAAxB,CAA3B,CAAmE,CAAC,MAAvE;AACE,YAAQ,CAAC,IAAT,GAAgB,QAAQ,CAAC,IAAT,IAAiB,EAAjC;WACA,CAAC,CAAC,MAAF,CAAS,QAAQ,CAAC,IAAlB,EAAwB,KAAK,CAAC,gBAA9B,EAFF;GAJ0B;AAAA,CAA5B;;AAAA,KAQK,CAAC,OAAO,CAAC,KAAK,CAAC,MAApB,CAA2B,SAAC,MAAD,EAAS,KAAT,EAAgB,UAAhB,EAA4B,QAA5B,EAAsC,OAAtC;AACzB;AAAA,MAAG,CAAC,CAAC,YAAF,CAAe,UAAf,EAA2B,CAAC,QAAD,CAA3B,CAAsC,CAAC,MAA1C;AACE,uBAAmB,KAAK,CAAC,eAAe,CAAC,KAAtB,CAA4B,KAA5B,CAAnB;AAAA,IACA,sBAAsB,gBAAgB,CAAC,mBAAjB,EADtB;AAEA,eAAG,KAAK,CAAC,SAAN,iBAAuB,mBAAvB,WAAH;aACE,KAAK,CAAC,OAAO,CAAC,MAAd,CAAqB,KAAK,CAAC,GAA3B,EAAgC;AAAA,QAAC,MAAM;AAAA,UAAC,WAAW,mBAAoB,GAApB,IAA0B,EAAtC;SAAP;OAAhC,EADF;KAHF;GADyB;AAAA,CAA3B,CARA","file":"/common/queries.hooks.coffee.js","sourcesContent":["share.Queries.before.update (userId, query, fieldNames, modifier, options) ->\n  if _.intersection(fieldNames, [\"output\", \"presentation\", \"startRecNum\", \"sortField\", \"sortReverse\", \"fields\", \"fieldsOrder\"]).length\n    modifier.$set = modifier.$set or {}\n    modifier.$set.isOutputStale = true\n  if _.intersection(fieldNames, [\"interface\", \"output\", \"presentation\"]).length\n    modifier.$set = modifier.$set or {}\n    _.extend(modifier.$set, share.queryBlankValues)\n\nshare.Queries.after.update (userId, query, fieldNames, modifier, options) ->\n  if _.intersection(fieldNames, [\"output\"]).length\n    transformedQuery = share.Transformations.query(query)\n    availableChartTypes = transformedQuery.availableChartTypes()\n    if query.chartType not in availableChartTypes\n      share.Queries.update(query._id, {$set: {chartType: availableChartTypes[0] or \"\"}})\n"]}